<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø³ÙŠØ§Ø±Ø© DC Ø¹Ø¨Ø± Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a237e;
            --secondary: #303f9f;
            --danger: #d32f2f;
            --success: #388e3c;
            --warning: #f57c00;
            --dark: #0d1b2a;
            --light: #e0e1dd;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
        }
        
        body {
            background: linear-gradient(135deg, #0d1b2a, #1b263b);
            color: white;
            min-height: 100vh;
            padding: 15px;
            overflow-x: hidden;
            touch-action: manipulation;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(224, 225, 221, 0.2);
        }
        
        header h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color: #e0e1dd;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        header p {
            font-size: 0.95rem;
            opacity: 0.9;
            color: #778da9;
        }
        
        .status-bar {
            background: rgba(224, 225, 221, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 18px;
            margin-bottom: 25px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(224, 225, 221, 0.15);
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
        }
        
        .status-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .connected .status-icon {
            background: linear-gradient(135deg, #4caf50, #2e7d32);
        }
        
        .disconnected .status-icon {
            background: linear-gradient(135deg, #f44336, #c62828);
        }
        
        .fire-detected .status-icon {
            background: linear-gradient(135deg, #ff5722, #d84315);
            animation: pulse 1.5s infinite;
        }
        
        .no-fire .status-icon {
            background: linear-gradient(135deg, #388e3c, #2e7d32);
        }
        
        .status-text {
            display: flex;
            flex-direction: column;
        }
        
        .status-label {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: 3px;
            color: #b0bec5;
        }
        
        .status-value {
            font-weight: 700;
            font-size: 1.1rem;
            color: #e0e1dd;
        }
        
        .control-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .control-panel {
            background: rgba(224, 225, 221, 0.08);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 22px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(224, 225, 221, 0.1);
        }
        
        .section-title {
            font-size: 1.3rem;
            margin-bottom: 22px;
            color: #e0e1dd;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(224, 225, 221, 0.2);
        }
        
        .section-title i {
            color: #778da9;
        }
        
        .direction-control {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 18px;
            touch-action: none;
            margin-bottom: 20px;
        }
        
        .direction-row {
            display: flex;
            justify-content: center;
            gap: 22px;
            width: 100%;
        }
        
        .control-btn {
            width: 80px;
            height: 80px;
            border: none;
            border-radius: 20px;
            background: linear-gradient(135deg, #1a237e, #283593);
            color: white;
            font-size: 2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
            box-shadow: 0 6px 20px rgba(26, 35, 126, 0.3);
            touch-action: manipulation;
            -webkit-touch-callout: none;
        }
        
        .control-btn:active {
            transform: scale(0.92);
            background: linear-gradient(135deg, #283593, #303f9f);
            box-shadow: 0 3px 10px rgba(26, 35, 126, 0.2);
        }
        
        .control-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .center-btn {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            box-shadow: 0 6px 20px rgba(245, 124, 0, 0.3);
        }
        
        .center-btn:active {
            background: linear-gradient(135deg, #f57c00, #ef6c00);
        }
        
        .fire-control {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .mode-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .mode-btn {
            flex: 1;
            padding: 16px;
            border: 2px solid rgba(224, 225, 221, 0.2);
            background: rgba(224, 225, 221, 0.08);
            border-radius: 12px;
            font-size: 1.05rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: #e0e1dd;
            touch-action: manipulation;
        }
        
        .mode-btn.active {
            background: linear-gradient(135deg, #303f9f, #283593);
            color: white;
            border-color: rgba(224, 225, 221, 0.3);
            box-shadow: 0 4px 15px rgba(40, 53, 147, 0.3);
        }
        
        .mode-btn:active:not(.active) {
            background: rgba(224, 225, 221, 0.15);
            transform: scale(0.97);
        }
        
        .manual-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        
        .fire-btn {
            padding: 18px;
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.15rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            touch-action: manipulation;
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.3);
        }
        
        .fire-btn:active:not(:disabled) {
            transform: scale(0.95);
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
        }
        
        .fire-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .fire-btn.stop {
            background: linear-gradient(135deg, #616161, #424242);
            box-shadow: 0 6px 20px rgba(66, 66, 66, 0.3);
        }
        
        .fire-btn.stop:active:not(:disabled) {
            background: linear-gradient(135deg, #424242, #212121);
        }
        
        .auto-status {
            background: rgba(224, 225, 221, 0.08);
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            font-size: 1rem;
            margin-top: 15px;
            border: 1px solid rgba(224, 225, 221, 0.1);
            color: #b0bec5;
        }
        
        .auto-status.fire-detected {
            background: rgba(244, 67, 54, 0.15);
            color: #ffcdd2;
            font-weight: bold;
            border-color: rgba(244, 67, 54, 0.3);
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .sensor-data {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px;
            margin-top: 22px;
        }
        
        .sensor-item {
            background: rgba(224, 225, 221, 0.08);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(224, 225, 221, 0.1);
        }
        
        .sensor-value {
            font-size: 1.9rem;
            font-weight: bold;
            color: white;
            margin: 10px 0;
            direction: ltr;
        }
        
        .sensor-label {
            font-size: 0.95rem;
            color: #778da9;
        }
        
        .connection-control {
            background: rgba(224, 225, 221, 0.08);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 22px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin-bottom: 25px;
            border: 1px solid rgba(224, 225, 221, 0.1);
        }
        
        .bluetooth-devices {
            margin-top: 15px;
            max-height: 220px;
            overflow-y: auto;
            background: rgba(13, 27, 42, 0.5);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid rgba(224, 225, 221, 0.1);
        }
        
        .device-item {
            padding: 14px;
            border-bottom: 1px solid rgba(224, 225, 221, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: background 0.2s;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .device-item:active {
            background: rgba(224, 225, 221, 0.1);
        }
        
        .device-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .device-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .device-name {
            font-weight: 600;
            color: #e0e1dd;
        }
        
        .device-id {
            font-size: 0.8rem;
            opacity: 0.7;
            font-family: monospace;
            color: #b0bec5;
        }
        
        .connect-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.15rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 15px;
            touch-action: manipulation;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        }
        
        .connect-btn:active:not(:disabled) {
            transform: scale(0.97);
            background: linear-gradient(135deg, #388e3c, #2e7d32);
        }
        
        .connect-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .connect-btn.disconnect {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.3);
        }
        
        .connect-btn.disconnect:active:not(:disabled) {
            background: linear-gradient(135deg, #d32f2f, #c62828);
        }
        
        .logs {
            background: rgba(224, 225, 221, 0.08);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 22px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            border: 1px solid rgba(224, 225, 221, 0.1);
        }
        
        .logs-content {
            background: rgba(13, 27, 42, 0.5);
            border-radius: 12px;
            padding: 16px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Cairo', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            border: 1px solid rgba(224, 225, 221, 0.1);
        }
        
        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid rgba(224, 225, 221, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .log-time {
            color: #778da9;
            font-size: 0.85rem;
            flex-shrink: 0;
            margin-right: 12px;
            direction: ltr;
        }
        
        .log-text {
            flex-grow: 1;
            word-break: break-word;
        }
        
        .log-info {
            color: #90caf9;
        }
        
        .log-success {
            color: #a5d6a7;
        }
        
        .log-error {
            color: #ef9a9a;
        }
        
        .log-warning {
            color: #ffcc80;
        }
        
        .log-bluetooth {
            color: #bb86fc;
        }
        
        footer {
            text-align: center;
            padding-top: 20px;
            color: #778da9;
            font-size: 0.85rem;
            border-top: 1px solid rgba(224, 225, 221, 0.2);
        }
        
        .instructions {
            background: rgba(26, 35, 126, 0.15);
            border-radius: 12px;
            padding: 18px;
            margin-top: 20px;
            font-size: 0.92rem;
            border: 1px solid rgba(26, 35, 126, 0.3);
        }
        
        .instructions h3 {
            color: #9fa8da;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
        }
        
        .instructions ul {
            padding-right: 20px;
            margin-bottom: 10px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.4;
            color: #b0bec5;
        }
        
        .flame-indicator {
            width: 100%;
            height: 8px;
            background: rgba(224, 225, 221, 0.1);
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .flame-level {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #ff9800, #f44336);
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .flame-value-text {
            text-align: center;
            margin-top: 5px;
            font-size: 0.85rem;
            color: #b0bec5;
        }
        
        @media (max-width: 380px) {
            .control-btn {
                width: 70px;
                height: 70px;
                font-size: 1.8rem;
            }
            
            .status-item {
                font-size: 0.92rem;
            }
            
            .sensor-value {
                font-size: 1.7rem;
            }
            
            .mode-btn, .fire-btn, .connect-btn {
                padding: 14px;
                font-size: 1rem;
            }
        }
        
        @media (min-width: 768px) {
            body {
                padding: 20px;
                max-width: 500px;
                margin: 0 auto;
            }
        }
        
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(224, 225, 221, 0.1);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(224, 225, 221, 0.3);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(224, 225, 221, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-car-side"></i> ØªØ­ÙƒÙ… Ø¨Ù„ÙˆØªÙˆØ« ÙÙŠ Ø³ÙŠØ§Ø±Ø© DC</h1>
            <p>Ù†Ø¸Ø§Ù… ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø¥Ø·ÙØ§Ø¡ Ø­Ø±Ø§Ø¦Ù‚ - Ù…Ø´Ø±ÙˆØ¹ ØªØ®Ø±Ø¬</p>
        </header>

        <div class="status-bar">
            <div class="status-item disconnected">
                <div class="status-icon">
                    <i class="fas fa-bluetooth-b"></i>
                </div>
                <div class="status-text">
                    <div class="status-label">Ø§Ù„Ø§ØªØµØ§Ù„:</div>
                    <div class="status-value" id="connection-status">ØºÙŠØ± Ù…ØªØµÙ„</div>
                </div>
            </div>
            <div class="status-item no-fire">
                <div class="status-icon">
                    <i class="fas fa-fire"></i>
                </div>
                <div class="status-text">
                    <div class="status-label">Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø±ÙŠÙ‚:</div>
                    <div class="status-value" id="fire-status">Ù„Ø§ ÙŠÙˆØ¬Ø¯</div>
                </div>
            </div>
            <div class="status-item">
                <div class="status-icon" style="background: linear-gradient(135deg, #303f9f, #283593);">
                    <i class="fas fa-cogs"></i>
                </div>
                <div class="status-text">
                    <div class="status-label">ÙˆØ¶Ø¹ Ø§Ù„ØªØ´ØºÙŠÙ„:</div>
                    <div class="status-value" id="operation-mode">ÙŠØ¯ÙˆÙŠ</div>
                </div>
            </div>
            <div class="status-item">
                <div class="status-icon" style="background: linear-gradient(135deg, #ff9800, #f57c00);">
                    <i class="fas fa-battery-three-quarters"></i>
                </div>
                <div class="status-text">
                    <div class="status-label">Ø·Ø§Ù‚Ø© Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©:</div>
                    <div class="status-value" id="battery-level">85%</div>
                </div>
            </div>
        </div>

        <div class="control-section">
            <div class="control-panel">
                <h2 class="section-title"><i class="fas fa-gamepad"></i> ØªØ­ÙƒÙ… ÙŠØ¯ÙˆÙŠ ÙÙŠ Ø§Ù„Ø³ÙŠØ§Ø±Ø©</h2>
                <div class="direction-control">
                    <div class="direction-row">
                        <button class="control-btn" id="forward-btn" data-direction="F">
                            <i class="fas fa-arrow-up"></i>
                        </button>
                    </div>
                    <div class="direction-row">
                        <button class="control-btn" id="left-btn" data-direction="L">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <button class="control-btn center-btn" id="stop-btn" data-direction="S">
                            <i class="fas fa-stop"></i>
                        </button>
                        <button class="control-btn" id="right-btn" data-direction="R">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    <div class="direction-row">
                        <button class="control-btn" id="backward-btn" data-direction="B">
                            <i class="fas fa-arrow-down"></i>
                        </button>
                    </div>
                </div>
                <div class="sensor-data">
                    <div class="sensor-item">
                        <div class="sensor-label">Ù‚Ø±Ø§Ø¡Ø© Ø­Ø³Ø§Ø³ Ø§Ù„Ù„Ù‡Ø¨</div>
                        <div class="sensor-value" id="flame-value">850</div>
                        <div class="flame-indicator">
                            <div class="flame-level" id="flame-level"></div>
                        </div>
                        <div class="flame-value-text">
                            <span id="flame-percent">85%</span> (Ø£Ø¹Ù„Ù‰ = Ø£Ù‚Ù„ Ù„Ù‡Ø¨)
                        </div>
                    </div>
                    <div class="sensor-item">
                        <div class="sensor-label">Ø¹ØªØ¨Ø© Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø­Ø±ÙŠÙ‚</div>
                        <div class="sensor-value" id="fire-threshold">500</div>
                        <div class="instructions" style="margin-top: 10px; padding: 10px; font-size: 0.8rem;">
                            <i class="fas fa-info-circle"></i> Ø£Ù‚Ù„ Ù…Ù† 500 = Ø­Ø±ÙŠÙ‚
                        </div>
                    </div>
                </div>
            </div>

            <div class="control-panel">
                <h2 class="section-title"><i class="fas fa-fire-extinguisher"></i> Ù†Ø¸Ø§Ù… Ø¥Ø·ÙØ§Ø¡ Ø§Ù„Ø­Ø±Ø§Ø¦Ù‚</h2>
                <div class="fire-control">
                    <div class="mode-selector">
                        <button class="mode-btn active" id="manual-mode-btn">
                            <i class="fas fa-hand-paper"></i> ÙŠØ¯ÙˆÙŠ
                        </button>
                        <button class="mode-btn" id="auto-mode-btn">
                            <i class="fas fa-robot"></i> ØªÙ„Ù‚Ø§Ø¦ÙŠ
                        </button>
                    </div>
                    
                    <div class="manual-controls">
                        <button class="fire-btn" id="activate-sprinkler-btn">
                            <i class="fas fa-fire-extinguisher"></i> ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø©
                        </button>
                        <button class="fire-btn stop" id="stop-sprinkler-btn">
                            <i class="fas fa-stop-circle"></i> Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø©
                        </button>
                    </div>
                    
                    <div class="auto-status" id="auto-status">
                        <i class="fas fa-info-circle"></i> Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ±Ø§Ù‚Ø¨ Ø§Ù„Ø­Ø±ÙŠÙ‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹. Ø£Ù‚Ù„ Ù…Ù† 500 = Ø­Ø±ÙŠÙ‚.
                    </div>
                </div>
                
                <div class="instructions">
                    <h3><i class="fas fa-info-circle"></i> ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„:</h3>
                    <ul>
                        <li>Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ« Ø£ÙˆÙ„Ø§Ù‹ (HC-05/HC-06)</li>
                        <li>ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙŠØ¯ÙˆÙŠ: Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</li>
                        <li>Ø¹Ù†Ø¯ Ø§ÙƒØªØ´Ø§Ù Ø­Ø±ÙŠÙ‚: ØªØªÙˆÙ‚Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙˆØªØ´ØºÙ„ Ø§Ù„Ù…Ø¶Ø®Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</li>
                        <li>ÙŠÙ…ÙƒÙ† ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="connection-control">
            <h2 class="section-title"><i class="fas fa-bluetooth-b"></i> Ø§ØªØµØ§Ù„ Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«</h2>
            <div class="bluetooth-devices" id="bluetooth-devices">
                <div class="device-item" style="text-align: center; color: #778da9; justify-content: center;">
                    <i class="fas fa-search"></i> Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«
                </div>
            </div>
            <button class="connect-btn" id="scan-btn">
                <i class="fas fa-search"></i> Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¬Ù‡Ø²Ø© Ø¨Ù„ÙˆØªÙˆØ«
            </button>
            <button class="connect-btn disconnect" id="disconnect-btn" style="display: none;">
                <i class="fas fa-unlink"></i> Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„
            </button>
        </div>

        <div class="logs">
            <h2 class="section-title"><i class="fas fa-clipboard-list"></i> Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</h2>
            <div class="logs-content" id="logs-content">
                <div class="log-entry log-info">
                    <span class="log-text">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«</span>
                    <span class="log-time" id="log-time">10:30:15</span>
                </div>
            </div>
        </div>

        <footer>
            <p>Ù…Ø´Ø±ÙˆØ¹ ØªØ®Ø±Ø¬ - Ø³ÙŠØ§Ø±Ø© DC Ù…Ø¹ Ù†Ø¸Ø§Ù… Ø¥Ø·ÙØ§Ø¡ Ø­Ø±Ø§Ø¦Ù‚ | Ø§Ù„ØªØ­ÙƒÙ… Ø¹Ø¨Ø± Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«</p>
            <p>Â© 2023 - Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Arduino + HC-05/HC-06</p>
        </footer>
    </div>

    <script>
        // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ - Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„ÙƒÙˆØ¯ Arduino
        const appState = {
            connected: false,
            fireDetected: false,
            sprinklerActive: false,
            batteryLevel: 85,
            flameValue: 850,
            fireThreshold: 500,
            device: null,
            server: null,
            characteristic: null,
            lastCommand: 'S',
            commandMap: {
                'forward': 'F',
                'backward': 'B',
                'left': 'L',
                'right': 'R',
                'stop': 'S',
                'sprinkler_on': 'P',
                'sprinkler_off': 'O'
            }
        };

        // Ø¹Ù†Ø§ØµØ± DOM
        const connectionStatus = document.getElementById('connection-status');
        const fireStatus = document.getElementById('fire-status');
        const operationMode = document.getElementById('operation-mode');
        const batteryLevel = document.getElementById('battery-level');
        const flameValue = document.getElementById('flame-value');
        const fireThreshold = document.getElementById('fire-threshold');
        const flameLevel = document.getElementById('flame-level');
        const flamePercent = document.getElementById('flame-percent');
        const autoStatus = document.getElementById('auto-status');
        const logsContent = document.getElementById('logs-content');
        const scanBtn = document.getElementById('scan-btn');
        const disconnectBtn = document.getElementById('disconnect-btn');
        const bluetoothDevices = document.getElementById('bluetooth-devices');
        
        // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
        const forwardBtn = document.getElementById('forward-btn');
        const backwardBtn = document.getElementById('backward-btn');
        const leftBtn = document.getElementById('left-btn');
        const rightBtn = document.getElementById('right-btn');
        const stopBtn = document.getElementById('stop-btn');
        
        // Ø£Ø²Ø±Ø§Ø± Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø·ÙØ§Ø¡
        const manualModeBtn = document.getElementById('manual-mode-btn');
        const autoModeBtn = document.getElementById('auto-mode-btn');
        const activateSprinklerBtn = document.getElementById('activate-sprinkler-btn');
        const stopSprinklerBtn = document.getElementById('stop-sprinkler-btn');

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
        function updateLogTime() {
            const now = new Date();
            return now.toLocaleTimeString('ar-EG', {hour12: false});
        }

        // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ø¬Ø¯ÙŠØ¯
        function addLog(message, type = 'info') {
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.innerHTML = `<span class="log-text">${message}</span> <span class="log-time">${updateLogTime()}</span>`;
            
            logsContent.appendChild(logEntry);
            logsContent.scrollTop = logsContent.scrollHeight;
            
            // Ø­ÙØ¸ ÙÙ‚Ø· Ø¢Ø®Ø± 30 Ø³Ø¬Ù„
            const logs = logsContent.querySelectorAll('.log-entry');
            if (logs.length > 30) {
                logs[0].remove();
            }
        }

        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function updateUI() {
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
            connectionStatus.textContent = appState.connected ? 'Ù…ØªØµÙ„' : 'ØºÙŠØ± Ù…ØªØµÙ„';
            connectionStatus.parentElement.parentElement.className = 
                `status-item ${appState.connected ? 'connected' : 'disconnected'}`;
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø±ÙŠÙ‚ (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ø³Ø§Ø³)
            const isFire = appState.flameValue < appState.fireThreshold;
            appState.fireDetected = isFire;
            
            fireStatus.textContent = isFire ? 'ğŸ”¥ Ø­Ø±ÙŠÙ‚!' : 'Ø¢Ù…Ù†';
            fireStatus.parentElement.parentElement.className = 
                `status-item ${isFire ? 'fire-detected' : 'no-fire'}`;
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©
            batteryLevel.textContent = `${appState.batteryLevel}%`;
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø§Øª
            flameValue.textContent = appState.flameValue;
            fireThreshold.textContent = appState.fireThreshold;
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù„Ù‡Ø¨ (Ù…Ø¹ÙƒÙˆØ³ Ù„Ø£Ù† Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£Ù‚Ù„ = Ù„Ù‡Ø¨ Ø£ÙƒØ«Ø±)
            const flamePercentValue = Math.min(100, Math.max(0, (appState.flameValue / 1023) * 100));
            flameLevel.style.width = `${flamePercentValue}%`;
            flamePercent.textContent = `${Math.round(flamePercentValue)}%`;
            
            // ØªØ­Ø¯ÙŠØ« Ù„ÙˆÙ† Ø§Ù„Ù…Ø¤Ø´Ø± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø©
            if (appState.flameValue < appState.fireThreshold) {
                flameLevel.style.background = 'linear-gradient(90deg, #f44336, #ff5722)';
            } else if (appState.flameValue < 700) {
                flameLevel.style.background = 'linear-gradient(90deg, #ff9800, #ff5722)';
            } else {
                flameLevel.style.background = 'linear-gradient(90deg, #4caf50, #8bc34a)';
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø´Ø§Ø´
            if (appState.sprinklerActive) {
                activateSprinklerBtn.innerHTML = '<i class="fas fa-fire-extinguisher"></i> Ø§Ù„Ù…Ø¶Ø®Ø© ØªØ¹Ù…Ù„...';
                activateSprinklerBtn.disabled = true;
                stopSprinklerBtn.disabled = false;
            } else {
                activateSprinklerBtn.innerHTML = '<i class="fas fa-fire-extinguisher"></i> ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø©';
                activateSprinklerBtn.disabled = !appState.connected;
                stopSprinklerBtn.disabled = true;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ ÙƒÙˆØ¯ Arduino)
            if (appState.fireDetected) {
                autoStatus.innerHTML = '<i class="fas fa-exclamation-triangle"></i> ğŸ”¥ ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø­Ø±ÙŠÙ‚! Ø§Ù„Ù…Ø¶Ø®Ø© ØªØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.';
                autoStatus.classList.add('fire-detected');
                
                // ØªØ¹Ø·ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¹Ù†Ø¯ Ø§ÙƒØªØ´Ø§Ù Ø­Ø±ÙŠÙ‚ (ÙƒÙ…Ø§ ÙÙŠ ÙƒÙˆØ¯ Arduino)
                [forwardBtn, backwardBtn, leftBtn, rightBtn].forEach(btn => {
                    btn.disabled = true;
                });
            } else {
                autoStatus.innerHTML = '<i class="fas fa-info-circle"></i> Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ±Ø§Ù‚Ø¨ Ø§Ù„Ø­Ø±ÙŠÙ‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹. Ø£Ù‚Ù„ Ù…Ù† 500 = Ø­Ø±ÙŠÙ‚.';
                autoStatus.classList.remove('fire-detected');
                
                // ØªÙ…ÙƒÙŠÙ† Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØµÙ„Ø§Ù‹
                [forwardBtn, backwardBtn, leftBtn, rightBtn, stopBtn].forEach(btn => {
                    btn.disabled = !appState.connected;
                });
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„
            if (appState.connected) {
                scanBtn.style.display = 'none';
                disconnectBtn.style.display = 'block';
            } else {
                scanBtn.style.display = 'block';
                disconnectBtn.style.display = 'none';
            }
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± Ø¹Ø¨Ø± Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ« Ø¥Ù„Ù‰ Arduino
        async function sendBluetoothCommand(commandChar) {
            if (!appState.connected || !appState.characteristic) {
                addLog('ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©', 'error');
                return false;
            }
            
            try {
                // Ø¥Ø±Ø³Ø§Ù„ Ø­Ø±Ù ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· ÙƒÙ…Ø§ ÙÙŠ ÙƒÙˆØ¯ Arduino
                const encoder = new TextEncoder();
                const data = encoder.encode(commandChar);
                
                await appState.characteristic.writeValue(data);
                addLog(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø±: '${commandChar}'`, 'bluetooth');
                console.log(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„: ${commandChar}`);
                
                // Ø­ÙØ¸ Ø¢Ø®Ø± Ø£Ù…Ø±
                appState.lastCommand = commandChar;
                return true;
            } catch (error) {
                addLog(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${error.message}`, 'error');
                return false;
            }
        }

        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¬Ù‡Ø²Ø© Ø¨Ù„ÙˆØªÙˆØ«
        async function scanBluetoothDevices() {
            try {
                addLog('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¬Ù‡Ø²Ø© Ø¨Ù„ÙˆØªÙˆØ«...', 'info');
                
                // Ø·Ù„Ø¨ Ø¬Ù‡Ø§Ø² Ø¨Ù„ÙˆØªÙˆØ« Ù…Ø¹ Ø®Ø¯Ù…Ø© ØªØ³Ù„Ø³Ù„ÙŠØ©
                const device = await navigator.bluetooth.requestDevice({
                    filters: [
                        {name: 'HC-05'},
                        {name: 'HC-06'},
                        {name: 'DC Car'},
                        {name: 'Arduino'},
                        {namePrefix: 'BT'},
                        {namePrefix: 'HC'}
                    ],
                    optionalServices: ['00001101-0000-1000-8000-00805f9b34fb'] // Ø®Ø¯Ù…Ø© ØªØ³Ù„Ø³Ù„ÙŠØ© Ù‚ÙŠØ§Ø³ÙŠØ©
                });
                
                if (!device) {
                    addLog('Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø¬Ù‡Ø§Ø²', 'warning');
                    return;
                }
                
                appState.device = device;
                addLog(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù‡Ø§Ø²: ${device.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`, 'success');
                
                // Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¬Ù‡Ø§Ø²
                await connectToBluetoothDevice(device);
                
            } catch (error) {
                if (error.name === 'NotFoundError') {
                    addLog('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø¬Ù‡Ø²Ø© Ø¨Ù„ÙˆØªÙˆØ«', 'error');
                } else if (error.name === 'SecurityError') {
                    addLog('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ù…Ù†Ø­ Ø¥Ø°Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«', 'error');
                } else if (error.name === 'AbortError') {
                    addLog('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¨Ø­Ø«', 'warning');
                } else {
                    addLog(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«: ${error.message}`, 'error');
                }
            }
        }

        // Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¬Ù‡Ø§Ø² Ø¨Ù„ÙˆØªÙˆØ«
        async function connectToBluetoothDevice(device) {
            try {
                addLog('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¬Ù‡Ø§Ø²...', 'info');
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø§ØªØµØ§Ù„
                device.addEventListener('gattserverdisconnected', onBluetoothDisconnected);
                
                // Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø§Ø¯Ù… GATT
                const server = await device.gatt.connect();
                appState.server = server;
                
                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠØ©
                const service = await server.getPrimaryService('00001101-0000-1000-8000-00805f9b34fb');
                
                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø®Ø§ØµÙŠØ© Ø§Ù„ÙƒØªØ§Ø¨Ø©
                const characteristic = await service.getCharacteristic('00001143-0000-1000-8000-00805f9b34fb');
                appState.characteristic = characteristic;
                
                appState.connected = true;
                addLog('ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± ØªÙˆÙ‚Ù Ø£ÙˆÙ„ÙŠ
                await sendBluetoothCommand('S');
                
                updateUI();
                
            } catch (error) {
                addLog(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}`, 'error');
                appState.connected = false;
                updateUI();
            }
        }

        // Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«
        async function disconnectBluetooth() {
            if (appState.device && appState.device.gatt.connected) {
                try {
                    // Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± ØªÙˆÙ‚Ù Ù‚Ø¨Ù„ Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„
                    await sendBluetoothCommand('S');
                    appState.device.gatt.disconnect();
                    addLog('ØªÙ… Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„', 'info');
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„:', error);
                }
            }
            
            appState.connected = false;
            appState.device = null;
            appState.server = null;
            appState.characteristic = null;
            
            updateUI();
        }

        // Ø¹Ù†Ø¯ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø§ØªØµØ§Ù„
        function onBluetoothDisconnected() {
            addLog('ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©', 'error');
            appState.connected = false;
            updateUI();
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø© (Pump ON)
        async function activateSprinkler() {
            if (appState.sprinklerActive) return;
            
            appState.sprinklerActive = true;
            addLog('Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ù…Ø¶Ø®Ø© Ø§Ù„Ù…ÙŠØ§Ù‡...', 'warning');
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± P Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø©
            const success = await sendBluetoothCommand('P');
            
            if (success) {
                addLog('ØªÙ… ØªØ´ØºÙŠÙ„ Ù…Ø¶Ø®Ø© Ø§Ù„Ù…ÙŠØ§Ù‡', 'success');
            }
            
            updateUI();
        }

        // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø© (Pump OFF)
        async function deactivateSprinkler() {
            if (!appState.sprinklerActive) return;
            
            appState.sprinklerActive = false;
            addLog('Ø¬Ø§Ø±ÙŠ Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¶Ø®Ø© Ø§Ù„Ù…ÙŠØ§Ù‡...', 'info');
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± O Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø©
            const success = await sendBluetoothCommand('O');
            
            if (success) {
                addLog('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¶Ø®Ø© Ø§Ù„Ù…ÙŠØ§Ù‡', 'success');
            }
            
            updateUI();
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³ Ù…Ù† Arduino
        function simulateSensorData() {
            if (!appState.connected) return;
            
            // ØªØºÙŠÙŠØ±Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø­Ø³Ø§Ø³ Ø§Ù„Ù„Ù‡Ø¨
            const flameChange = (Math.random() - 0.5) * 50;
            appState.flameValue = Math.max(0, Math.min(1023, appState.flameValue + flameChange));
            
            // Ø§ÙƒØªØ´Ø§Ù Ø­Ø±ÙŠÙ‚ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„Ù„Ù…Ø­Ø§ÙƒØ§Ø© (5% ÙØ±ØµØ©)
            if (Math.random() < 0.05 && !appState.fireDetected) {
                appState.flameValue = Math.floor(Math.random() * 400); // Ù‚ÙŠÙ…Ø© Ù…Ù†Ø®ÙØ¶Ø© ØªØ´ÙŠØ± Ø¥Ù„Ù‰ Ø­Ø±ÙŠÙ‚
                addLog('ğŸ”¥ ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø­Ø±ÙŠÙ‚ (Ù…Ø­Ø§ÙƒØ§Ø©)', 'error');
                
                // Ø¥Ø°Ø§ Ø§ÙƒØªØ´Ù Ø­Ø±ÙŠÙ‚ØŒ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                setTimeout(() => activateSprinkler(), 1000);
                
                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø© Ø¨Ø¹Ø¯ 7 Ø«ÙˆØ§Ù†Ù (ÙƒÙ…Ø§ ÙÙŠ ÙƒÙˆØ¯ Arduino)
                setTimeout(() => {
                    if (appState.sprinklerActive) {
                        deactivateSprinkler();
                        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø³Ø§Ø³ Ø¨Ø¹Ø¯ Ø¥Ø®Ù…Ø§Ø¯ Ø§Ù„Ø­Ø±ÙŠÙ‚
                        appState.flameValue = 800 + Math.floor(Math.random() * 200);
                    }
                }, 8000);
            }
            
            // Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©
            if (appState.sprinklerActive) {
                appState.batteryLevel = Math.max(0, appState.batteryLevel - 0.5);
            } else {
                appState.batteryLevel = Math.max(0, appState.batteryLevel - 0.1);
            }
            
            // Ø¥Ø°Ø§ Ø§Ù†Ø®ÙØ¶Øª Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© Ø¹Ù† 10%ØŒ Ø¥Ø¹Ø§Ø¯Ø© Ø´Ø­Ù† Ø¹Ø´ÙˆØ§Ø¦ÙŠ
            if (appState.batteryLevel < 10 && Math.random() < 0.1) {
                appState.batteryLevel = 50 + Math.floor(Math.random() * 40);
                addLog('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø´Ø­Ù† Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©', 'success');
            }
            
            updateUI();
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        function setupEventListeners() {
            // Ø²Ø± Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¬Ù‡Ø²Ø© Ø¨Ù„ÙˆØªÙˆØ«
            scanBtn.addEventListener('click', scanBluetoothDevices);
            
            // Ø²Ø± Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„
            disconnectBtn.addEventListener('click', disconnectBluetooth);
            
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ - Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„ÙƒÙˆØ¯ Arduino
            forwardBtn.addEventListener('click', async () => {
                if (!appState.connected || appState.fireDetected) return;
                await sendBluetoothCommand('F');
            });
            
            backwardBtn.addEventListener('click', async () => {
                if (!appState.connected || appState.fireDetected) return;
                await sendBluetoothCommand('B');
            });
            
            leftBtn.addEventListener('click', async () => {
                if (!appState.connected || appState.fireDetected) return;
                await sendBluetoothCommand('L');
            });
            
            rightBtn.addEventListener('click', async () => {
                if (!appState.connected || appState.fireDetected) return;
                await sendBluetoothCommand('R');
            });
            
            stopBtn.addEventListener('click', async () => {
                if (!appState.connected) return;
                await sendBluetoothCommand('S');
            });
            
            // Ø£Ø²Ø±Ø§Ø± Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø·ÙØ§Ø¡
            manualModeBtn.addEventListener('click', async () => {
                addLog('Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ù…ÙØ¹Ù„', 'info');
                manualModeBtn.classList.add('active');
                autoModeBtn.classList.remove('active');
            });
            
            autoModeBtn.addEventListener('click', async () => {
                addLog('Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…ÙØ¹Ù„', 'info');
                autoModeBtn.classList.add('active');
                manualModeBtn.classList.remove('active');
            });
            
            activateSprinklerBtn.addEventListener('click', async () => {
                if (!appState.connected) return;
                await activateSprinkler();
            });
            
            stopSprinklerBtn.addEventListener('click', async () => {
                if (!appState.connected) return;
                await deactivateSprinkler();
            });
            
            // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            document.addEventListener('keydown', async (e) => {
                if (!appState.connected || appState.fireDetected) return;
                
                switch(e.key.toLowerCase()) {
                    case 'arrowup':
                    case 'w':
                        forwardBtn.click();
                        forwardBtn.style.transform = 'scale(0.92)';
                        break;
                    case 'arrowdown':
                    case 's':
                        backwardBtn.click();
                        backwardBtn.style.transform = 'scale(0.92)';
                        break;
                    case 'arrowleft':
                    case 'a':
                        leftBtn.click();
                        leftBtn.style.transform = 'scale(0.92)';
                        break;
                    case 'arrowright':
                    case 'd':
                        rightBtn.click();
                        rightBtn.style.transform = 'scale(0.92)';
                        break;
                    case ' ':
                    case 'x':
                        stopBtn.click();
                        stopBtn.style.transform = 'scale(0.92)';
                        break;
                    case 'p':
                        if (!appState.sprinklerActive) {
                            activateSprinklerBtn.click();
                        }
                        break;
                    case 'o':
                        if (appState.sprinklerActive) {
                            stopSprinklerBtn.click();
                        }
                        break;
                }
            });
            
            document.addEventListener('keyup', () => {
                [forwardBtn, backwardBtn, leftBtn, rightBtn, stopBtn].forEach(btn => {
                    btn.style.transform = '';
                });
            });
            
            // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù†Ø¯ Ù„Ù…Ø³ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            const controlButtons = document.querySelectorAll('.control-btn, .mode-btn, .fire-btn, .connect-btn');
            controlButtons.forEach(btn => {
                btn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                }, {passive: false});
                
                btn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                }, {passive: false});
            });
            
            // ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³ Ø§Ù„Ù…Ø·ÙˆÙ„ Ù„Ù„Ø£Ø²Ø±Ø§Ø±
            let touchTimer;
            controlButtons.forEach(btn => {
                btn.addEventListener('touchstart', (e) => {
                    touchTimer = setTimeout(() => {
                        if (btn.id === 'stop-btn') {
                            btn.click();
                        }
                    }, 1000);
                });
                
                btn.addEventListener('touchend', () => {
                    clearTimeout(touchTimer);
                });
            });
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function init() {
            addLog('Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Arduino', 'success');
            addLog('Ø§Ø³ØªØ®Ø¯Ù… HC-05/HC-06 Ù„Ù„Ø§ØªØµØ§Ù„', 'info');
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ø¹Ù… Web Bluetooth API
            if (!navigator.bluetooth) {
                addLog('âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Web Bluetooth API', 'error');
                addLog('ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Chrome Ø¹Ù„Ù‰ Android Ø£Ùˆ Edge Ø¹Ù„Ù‰ Windows', 'warning');
                scanBtn.disabled = true;
                scanBtn.innerHTML = '<i class="fas fa-times-circle"></i> Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ« ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…';
            }
            
            setupEventListeners();
            updateUI();
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³ ÙƒÙ„ Ø«Ø§Ù†ÙŠØªÙŠÙ†
            setInterval(simulateSensorData, 2000);
            
            // Ø¥Ø¸Ù‡Ø§Ø± ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
            setTimeout(() => {
                addLog('Ù„Ù„Ø§ØªØµØ§Ù„: 1) Ø´ØºÙ„ Ø¨Ù„ÙˆØªÙˆØ« Ø§Ù„Ø³ÙŠØ§Ø±Ø© 2) Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„Ø¨Ø­Ø«', 'info');
            }, 1500);
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
